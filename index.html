<!DOCTYPE html>
<html lang=id>
	<head>
		<title>Unicode cipher</title>
		<meta
			http-equiv=Content-Type
			content="text/html; charset=utf-8"/>
		<script
			src="https://code.jquery.com/jquery-3.6.0.min.js"></script></head>
	<body>
		<div style="background-color: lightgreen;">
			<p>Original Text:</p>
			<textarea id="teks.input"
				rows="30"
				cols="100"
				spellcheck="false" 
				autocapitalize="off"></textarea>
			<br>
			<input id="loadFile.asDataURL"
				onchange="loadFile.asDataURL(this); //JS"
				type="file"/>
				<label for="loadFile.asDataURL">File to data URL Base64</label>
			<br>
			<input id="loadFile.asCipheredText"
				onchange="loadFile.asCipheredText(this); //JS"
				type="file"
				accept=".ciphereki"/>
				<label for="loadFile.asCipheredText">Ciphereki to Text</label></div>
		<div style="background-color: lightblue;">
			<p>Caesar Key:</p>
			<input id="caesar.input"
				oninput="caesar.setKey(); //JS"
				type="text"
				size="98"/>
			<br>
			<input id="caesar.direction"
				onclick="caesar.setDirection(); //JS"
				type="button"
				value="+"/></div>
		<div style="background-color: lightpink;">
			<p>Vigenere Key:</p>
			<textarea id="vigenere.input"
				oninput="vigenere.setKey(); //JS"
				rows="10"
				cols="100"></textarea>
			<br>
			<input id="vigenere.direction"
				onclick="vigenere.setDirection(); //JS"
				type="button"
				value="+"/></div>
		<div style="background-color: mediumpurple;">
			<input id="cipher.run"
				onclick="cipher.run(); //JS"
				type="button"
				value="Jalankan cipher"/>
			<p>Cipher Text:</p>
			<textarea id="teks.output"
				rows="30"
				cols="100"
				spellcheck="false"
				autocapitalize="off"
				readonly></textarea>
			<br>
			<input id="saveText.fileName"
				type="text"/>
			<input id="saveText.fromDataURL"
				onclick="saveText.fromDataURL(); //JS"
				type="button"
				value="Save File"/>
				<label for="saveText.fromDataURL">Data URL Base64 to File</label>
			<input id="saveText.fromCipheredText"
				onclick="saveText.fromCipheredText(); //JS"
				type="button" 
				value="Save File"/>
				<label for="saveText.fromCipheredText">Text to Ciphereki</label></div>
		<script>
			"use strict";
			const caesar = function() {
				let key = 0;
				let direction = 1;
				const publicFunctions = {
					getKey: function() {
						return key;
					},
					setKey: function() {
						$("#caesar\\.input").val($("#caesar\\.input")
							.val().replace(/[^0-9]/g, ''));
						let input = $("#caesar\\.input").val();
						if (input.length === 0) {
							key = 0;
						} else {
							key = parseInt(input) * direction;
						}
					},
					setDirection: function() {
						if (direction === 1) {
							$("#caesar\\.direction").val("-");
						} else {
							$("#caesar\\.direction").val("+");
						}
						direction *= -1;
						this.setKey();
					},
				};
				Object.freeze(publicFunctions);
				return publicFunctions;
			}();
			const vigenere = function() {
				let key = [0];
				let direction = 1;
				const publicFunctions = {
					getKey: function() {
						return key;
					},
					setKey: function() {
						const input = [...$("#vigenere\\.input").val()];
						if (input.length === 0) {
							key = [0];
						} else {
							for (let i = 0; i < input.length; i++) {
								key[i] = input[i].codePointAt(0) * direction;
							}
						}
					},
					setDirection: function() {
						if (direction === 1) {
							$("#vigenere\\.direction").val("-");
						} else {
							$("#vigenere\\.direction").val("+");
						}
						direction *= -1;
						this.setKey();
					},
				};
				Object.freeze(publicFunctions);
				return publicFunctions;
			}();
			const loadFile = function() {
				const fileReader = new FileReader();
				const publicFunctions = {
					asDataURL: function(input) {
						fileReader.readAsDataURL(input.files[0]);
						fileReader.onload = function(event) {
							$("#teks\\.input").val(event.target.result);
							$("#loadFile\\.asDataURL").val("");
						};
					},
					asCipheredText: function(input) {
						fileReader.readAsText(input.files[0]);
						fileReader.onload = function(event) {
							const encode = event.target.result.split(" ");
							for (let i = 0; i < encode.length; i++) {
								encode[i] =
									String.fromCodePoint(parseInt(encode[i], 16));
							}
							$("#teks\\.input").val(encode.join(""));
							$("#loadFile\\.asCipheredText").val("");
						};
					},
				};
				Object.freeze(publicFunctions);
				return publicFunctions;
			}();
			const cipher = function() {
				const publicFunctions = {
					run: function() {
						const caesarKey = caesar.getKey();
						const vigenereKey = vigenere.getKey();
						let vigenereIndex = 0;
						const textInput = $("#teks\\.input").val();
						const characterArray = [...textInput];
						let currentCodePoint;
						for (let i = 0; i < characterArray.length; i++) {
							currentCodePoint = characterArray[i].codePointAt(0);
							if (currentCodePoint === 0) {
								characterArray[i] = "";
							} else {
								if (currentCodePoint === 1) {
									currentCodePoint = 13;
								}
								currentCodePoint =
									currentCodePoint +
									caesarKey +
									vigenereKey[vigenereIndex];
								while (currentCodePoint < 2) {
									currentCodePoint += 1114110;
								}
								while (currentCodePoint > 1114111) {
									currentCodePoint -= 1114110;
								}
								if (currentCodePoint === 13) {
									currentCodePoint = 1;
								}
								characterArray[i] =
									String.fromCodePoint(currentCodePoint);
								vigenereIndex += 1;
								if (vigenereIndex === vigenereKey.length) {
									vigenereIndex = 0;
								}
							}
						}
						if (textInput.split("\x00").length > 1) {
							$("#teks\\.output").val(characterArray.join(""));
						} else {
							$("#teks\\.output")
								.val(characterArray.join(String.fromCodePoint(0)));
						}
					}
				}
				Object.freeze(publicFunctions);
				return publicFunctions;
			}();
			const saveText = function() {
				const getFileName = function() {
					let fileName = $("#saveText\\.fileName").val();
					if (fileName.length === 0) {
						fileName = "fileName";
					}
					return fileName;
				};
				const downloadFile = function(fileName, file) {
					const a = document.createElement("a");
					a.style = "display: none";
					a.href = URL.createObjectURL(file);
					a.download = fileName;
					document.body.appendChild(a);
					a.click();
					a.remove();
				};
				const publicFunctions = {
					fromDataURL: function() {
						try {
							const fileName = getFileName();
							const arr = $("#teks\\.output").val().split(',');
							const binary = atob(arr[1]);
							const u8arr = new Uint8Array(binary.length);
							for (let n = 0; n < binary.length; n++) {
								u8arr[n] = binary.codePointAt(n);
							}
							const file = new File([u8arr], "", {
								type: arr[0].match(/:(.*?);/)[1]
							});
							downloadFile(fileName, file);
						} catch (err) {
							alert("Error: Only accept valid data URL Base64 format!");
						}
					},
					fromCipheredText: function() {
						const fileName = getFileName();
						const characters = [...$("#teks\\.output").val()];
						const codepoints = [];
						for (let i = 0; i < characters.length; i++) {
							codepoints[i] = characters[i].codePointAt(0).toString(16);
						}
						const file = new Blob([codepoints.join(" ")], {
							type: "text/plain"
						});
						downloadFile(fileName + ".ciphereki", file);
					},
				};
				Object.freeze(publicFunctions);
				return publicFunctions;
			}();</script></body></html>
<!-- Ini Komentar -->